# 視覺小說界面設計規格

## 🎯 設計目標

創建一個現代化的視覺小說(gal game)對話界面，具有玻璃態設計、柔和漸變和精緻的微交互效果。

## 📱 視口規格

- **平台**: Android 豎屏
- **分辨率**: 1080×2400
- **安全區域**: 已考慮狀態欄和導航欄

## 🎨 設計風格關鍵詞

- **現代galgame**: 簡潔、優雅的視覺設計
- **玻璃態設計**: 半透明背景、模糊效果
- **柔和漸變**: 自然的色彩過渡
- **圓角設計**: 24px 統一圓角
- **微妙光暈**: 柔和的陰影和發光效果
- **極簡鉻元素**: 最少的裝飾元素
- **散景暈影**: 背景漸變遮罩

## 🏗️ 布局結構 (從上到下，分層)

### 1. 背景CG層
- **圖片**: `classroom.jpg` (教室日間場景)
- **遮罩**: 頂部30%深色到透明垂直漸變
- **漸變**: `rgba(0,0,0,0.35)` 頂部 → 0 底部
- **停止點**: [0.0, 0.3]

### 2. 角色立繪層
- **位置**: 右下角錨定
- **尺寸**: 280×420 (約60-70%高度)
- **陰影**: 柔和投影，模糊20px，偏移(0, 10)
- **動畫**: 1600ms緩入，easeOutCubic曲線

### 3. 標題欄層
- **位置**: 頂部安全區域+20px
- **內容**: 左側顯示「冷淡ちゃんとの会話」
- **右側**: 齒輪圖標(設定) + 迷你菜單(自動/跳過/履歷)
- **樣式**: 半透明黑色背景，24px圓角，玻璃態邊框

### 4. 對話框層
- **位置**: 底部固定
- **樣式**: 白色88%透明度，模糊12px，圓角24px
- **名稱標籤**: 左上角「冷淡ちゃん」(粉色強調 #FF6EA8)
- **正文**: 日文，2-3行可見，18-20pt，行高140%
- **下一個指示器**: 右下角「▶」圖標，溫和脈動
- **TTS圖標**: 對話框右邊緣的小揚聲器圖標

### 5. 選擇覆蓋層 (需要時)
- **樣式**: 2-3個藥丸按鈕，居中於對話框上方
- **設計**: 玻璃態，淺色邊框，聚焦項目發光

### 6. 履歷覆蓋層
- **樣式**: 全屏覆蓋，模糊背景
- **內容**: 左對齊文本列表，可滾動
- **關閉**: X按鈕

## 🎨 主題色彩

### 主要色彩
- **主色**: `#FF6EA8` (粉色)
- **輔色**: `#5AC8FA` (藍色)
- **背景暈影**: `rgba(0,0,0,0.35)` 頂部 → 0 底部
- **對話框**: `#E1FFFFFF` (88%透明度白色)

### 色彩使用
- **名稱標籤**: 主色背景
- **TTS圖標**: 主色
- **下一個指示器**: 主色
- **自動模式指示器**: 主色80%透明度
- **設定按鈕**: 主色
- **用戶消息**: 輔色
- **AI消息**: 主色

## 🔤 字體規格

### 字體家族
- **UI文本**: Noto Sans JP
- **標題**: Noto Sans JP (可選: Shippori Mincho)

### 字體大小
- **標題**: 20pt
- **對話正文**: 18pt
- **名稱標籤**: 14pt
- **按鈕文本**: 16pt
- **提示文本**: 16pt

### 行高
- **對話正文**: 140%
- **列表項目**: 140%

## 🎭 微交互

### 動畫時間
- **對話框淡入**: 160ms
- **角色立繪**: 1600ms
- **下一個指示器脈動**: 1200ms

### 交互效果
- **角色立繪**: 輕微視差滾動效果
- **自動模式**: 標題欄附近顯示小「AUTO」標籤
- **設定面板**: 浮動面板，包含滑塊(音聲速度、音調、音量)、語言選擇

## 📐 間距規格

### 邊距
- **左右邊距**: 24px
- **頂部邊距**: 安全區域+20px
- **底部邊距**: 安全區域+20px

### 內邊距
- **標題欄**: 20px水平，12px垂直
- **對話框**: 24px
- **名稱標籤**: 16px水平，8px垂直
- **輸入區域**: 20px

### 間距
- **元素間距**: 16px
- **標籤與正文**: 16px
- **正文與底部**: 16px

## 🔧 功能特性

### 音声播放
- **自動播放**: AI回覆後自動開始TTS音声
- **狀態指示**: 對話框右側顯示音声播放圖標
- **錯誤處理**: 完善的錯誤提示和恢復機制

### 用戶交互
- **點擊繼續**: 顯示「タップして続行」提示
- **隱藏輸入**: 點擊後顯示輸入區域
- **自動隱藏**: 發送消息後自動隱藏輸入區域

### 設置選項
- **音声速度**: 0.5x - 2.0x
- **音声音調**: -12 到 +12
- **音量**: 0.0 - 1.0

## 🎮 狀態管理

### 布爾狀態
- `_isTyping`: 正在輸入
- `_isPlayingVoice`: 音声播放中
- `_isAutoMode`: 自動模式
- `_showBacklog`: 顯示履歷
- `_showSettings`: 顯示設定
- `_showInputArea`: 顯示輸入區域

### 動畫控制器
- `_characterAnimationController`: 角色動畫
- `_dialogAnimationController`: 對話框動畫
- `_nextIndicatorController`: 下一個指示器動畫

## 🚫 設計約束

- **無時間戳**: 不顯示消息時間
- **無頭像**: 不使用圓形頭像
- **無左右氣泡**: 不使用聊天氣泡布局
- **非聊天室**: 不是聊天室布局，而是視覺小說對話界面

## 📱 響應式設計

### 安全區域適配
- 使用 `MediaQuery.of(context).padding` 適配狀態欄
- 底部導航欄適配
- 左右邊距保持24px

### 尺寸適配
- 角色立繪使用固定尺寸但可縮放
- 對話框寬度自適應屏幕寬度
- 字體大小保持固定以確保可讀性

## 🎯 成功標準

1. ✅ 界面完全符合視覺小說風格
2. ✅ 所有動畫流暢自然
3. ✅ 音声播放功能正常
4. ✅ 用戶交互直觀易用
5. ✅ 設計元素統一協調
6. ✅ 性能優化良好
7. ✅ 錯誤處理完善
8. ✅ 響應式適配正確
